## 离散型随机变量
### 2.1 一维随机变量及分布列
例子：
---
| $\eta$ | 1       | 2             | 3               | 4                 | 5                   |
| ------ | ------- | ------------- | --------------- | ----------------- | ------------------- |
| $P$    | $p$     | $p(1 - p)$    | $p(1 - p)^2$    | $p(1 - p)^3$      | $(1 - p)^4$         |
---

体现为二项分布
在第一章里曾经提到，必然事件 \( \Omega \) 可以作为随机事件的极端情形来看待，相应地，在 \( \Omega \) 上有定义的恒等于常数 \( a \) 的变量 \( \xi \)（虽然它的取值已经失去随机性），也可以看作为随机变量的极端情形。这时，随机变量 \( \xi \) 的分布列为
\[
P(\xi = a) = 1 \tag{2.10}
\]
人们称这个分布为单点分布或退化分布。
#### 例 2.3
在一个伯努利试验中，每次试验成功的概率为 \( p \)，失败的概率为 \( q = 1 - p \)（\( 0 < p < 1 \)），设试验进行到第 \( \xi \) 次才出现成功，求 \( \xi \) 的分布列。

**解**：由相关知识可知
\[
P(\xi = k) = pq^{k - 1}, k = 1, 2, \cdots
\]
容易看到 \( pq^{k - 1} (k = 1, 2, \cdots) \) 是几何级数 \( \sum_{k = 1}^{+\infty} pq^{k - 1} \) 的一般项，于是人们称它为几何分布，并记为 \( \xi \sim Ge(p) \)。
要证明随机变量\(\xi\)服从参数为\(\lambda\)的泊松分布\(P(\xi = k)=\frac{\lambda^{k}}{k!}\mathrm{e}^{-\lambda},k = 0,1,2,\cdots\)，可以从二项分布的极限情况来推导，即泊松定理。

#### 泊松定理
设\(\lambda>0\)是一个常数，\(n\)是任意正整数，设\(np_{n}=\lambda\)（即\(p_{n}=\frac{\lambda}{n}\)），则对于固定的非负整数\(k\)，有
\[
\lim_{n\rightarrow\infty}C_{n}^{k}p_{n}^{k}(1 - p_{n})^{n - k}=\frac{\lambda^{k}}{k!}\mathrm{e}^{-\lambda}
\]

#### 证明过程
1. 首先，将二项分布的概率质量函数展开：
   - 二项分布的概率质量函数为\(P(X = k)=C_{n}^{k}p^{k}(1 - p)^{n - k}\)，其中\(C_{n}^{k}=\frac{n(n - 1)\cdots(n - k + 1)}{k!}\)。
   - 已知\(np=\lambda\)，即\(p = \frac{\lambda}{n}\)，将其代入二项分布的概率质量函数中，得到：
\[
\begin{align*}
P(X = k)&=\frac{n(n - 1)\cdots(n - k + 1)}{k!}\left(\frac{\lambda}{n}\right)^{k}\left(1-\frac{\lambda}{n}\right)^{n - k}\\
&=\frac{\lambda^{k}}{k!}\cdot\frac{n(n - 1)\cdots(n - k + 1)}{n^{k}}\cdot\left(1-\frac{\lambda}{n}\right)^{n}\cdot\left(1-\frac{\lambda}{n}\right)^{-k}
\end{align*}
\]
2. 然后，分析当\(n\rightarrow\infty\)时各项的极限：
   - 对于\(\frac{n(n - 1)\cdots(n - k + 1)}{n^{k}}\)，当\(n\rightarrow\infty\)时，\(\frac{n - i}{n}\rightarrow1\)（\(i = 0,1,\cdots,k - 1\)），所以\(\lim_{n\rightarrow\infty}\frac{n(n - 1)\cdots(n - k + 1)}{n^{k}} = 1\)。
   - 对于\(\left(1-\frac{\lambda}{n}\right)^{n}\)，根据重要极限\(\lim_{n\rightarrow\infty}\left(1+\frac{x}{n}\right)^{n}=\mathrm{e}^{x}\)，这里\(x = -\lambda\)，所以\(\lim_{n\rightarrow\infty}\left(1-\frac{\lambda}{n}\right)^{n}=\mathrm{e}^{-\lambda}\)。
   - 对于\(\left(1-\frac{\lambda}{n}\right)^{-k}\)，当\(n\rightarrow\infty\)时，\(\frac{\lambda}{n}\rightarrow0\)，所以\(\lim_{n\rightarrow\infty}\left(1-\frac{\lambda}{n}\right)^{-k}=1\)。
3. 最后，求极限：
   综合以上各项的极限，当\(n\rightarrow\infty\)时：
\[
\begin{align*}
\lim_{n\rightarrow\infty}P(X = k)&=\frac{\lambda^{k}}{k!}\cdot1\cdot\mathrm{e}^{-\lambda}\cdot1\\
&=\frac{\lambda^{k}}{k!}\mathrm{e}^{-\lambda}
\end{align*}
\]

这就说明，当\(n\)很大，\(p\)很小时（此时\(np=\lambda\)大小适中），二项分布可以用泊松分布来近似。而电话局单位时间内收到的呼唤次数、公共汽车站单位时间里来站乘车的乘客数等，都可以看作是大量独立试验（每次试验对应是否有一次呼唤、是否有一个乘客到来等）中“成功”（有呼唤、有乘客到来等）次数的极限情况，所以它们的分布近似服从泊松分布。
### 2.2 多维随机变量，联合分布列和边际分布列
* 其实就是个表，**边际分布**就是行和列
* 由边际分布列并不能唯一地确定联合分布列
#### 定义 2.3
设离散型随机变量\(\xi\)的可能取值为\(a_{i}(i = 1,2,\cdots)\)，\(\eta\)的可能取值为\(b_{j}(j = 1,2,\cdots)\)，如果对任意的\(a_{i},b_{j}\)，有
\[
P(\xi = a_{i},\eta = b_{j}) = P(\xi = a_{i})P(\eta = b_{j})
\]
成立，则称离散型随机变量\(\xi\)和\(\eta\)相互独立。
### 2.3 随机变量函数的分布列
要详细证明两个独立泊松分布随机变量之和仍服从泊松分布，我们逐步分析每一步推导：


#### 步骤1：利用独立随机变量和的概率公式
对于两个随机变量\(\xi\)和\(\eta\)，随机变量\(\zeta = \xi + \eta\)取\(k\)值的概率为：
\[
P(\zeta = k) = \sum_{i = 0}^{k} P(\xi = i, \eta = k - i)
\]
这是因为\(\xi + \eta = k\)等价于“\(\xi = i\)且\(\eta = k - i\)”（\(i\)从\(0\)到\(k\)遍历所有可能）。


#### 步骤2：代入独立随机变量的联合概率公式
由于\(\xi\)与\(\eta\)相互独立，根据**独立随机变量的联合概率性质**：
\[
P(\xi = i, \eta = k - i) = P(\xi = i) \cdot P(\eta = k - i)
\]

已知\(\xi \sim P(\lambda_1)\)（参数为\(\lambda_1\)的泊松分布），其概率质量函数为：
\[
P(\xi = i) = \frac{\lambda_1^i}{i!} e^{-\lambda_1} \quad (i = 0,1,2,\cdots)
\]

同理，\(\eta \sim P(\lambda_2)\)，其概率质量函数为：
\[
P(\eta = k - i) = \frac{\lambda_2^{k - i}}{(k - i)!} e^{-\lambda_2} \quad (k - i = 0,1,2,\cdots)
\]

将这两个概率代入\(P(\zeta = k)\)的表达式，得：
\[
P(\zeta = k) = \sum_{i = 0}^{k} \left( \frac{\lambda_1^i}{i!} e^{-\lambda_1} \right) \cdot \left( \frac{\lambda_2^{k - i}}{(k - i)!} e^{-\lambda_2} \right)
\]


#### 步骤3：整理指数与求和项
将指数部分\(e^{-\lambda_1}\)和\(e^{-\lambda_2}\)合并（根据指数运算法则\(e^a \cdot e^b = e^{a + b}\)）：
\[
e^{-\lambda_1} \cdot e^{-\lambda_2} = e^{-(\lambda_1 + \lambda_2)}
\]

将其提出求和符号外，得到：
\[
P(\zeta = k) = e^{-(\lambda_1 + \lambda_2)} \sum_{i = 0}^{k} \frac{\lambda_1^i \cdot \lambda_2^{k - i}}{i! \cdot (k - i)!}
\]


#### 步骤4：利用二项式定理化简求和项
回忆**二项式定理**：对于任意实数\(a, b\)和正整数\(n\)，有
\[
(a + b)^n = \sum_{i = 0}^{n} \frac{n!}{i! \cdot (n - i)!} a^i b^{n - i}
\]

观察求和项\(\sum_{i = 0}^{k} \frac{\lambda_1^i \cdot \lambda_2^{k - i}}{i! \cdot (k - i)!}\)，与二项式定理对比：
- 令\(a = \lambda_1\)，\(b = \lambda_2\)，\(n = k\)；
- 注意到\(\frac{k!}{i! \cdot (k - i)!}\)是二项式系数，因此两边同除以\(k!\)，得：
\[
\frac{(a + b)^k}{k!} = \sum_{i = 0}^{k} \frac{a^i \cdot b^{k - i}}{i! \cdot (k - i)!}
\]

将\(a = \lambda_1\)，\(b = \lambda_2\)代入，求和项可化简为：
\[
\sum_{i = 0}^{k} \frac{\lambda_1^i \cdot \lambda_2^{k - i}}{i! \cdot (k - i)!} = \frac{(\lambda_1 + \lambda_2)^k}{k!}
\]


#### 步骤5：得到最终分布
将化简后的求和项代入\(P(\zeta = k)\)的表达式，得：
\[
P(\zeta = k) = e^{-(\lambda_1 + \lambda_2)} \cdot \frac{(\lambda_1 + \lambda_2)^k}{k!} \quad (k = 0,1,2,\cdots)
\]

这正是**参数为\(\lambda_1 + \lambda_2\)的泊松分布**的概率质量函数，因此\(\zeta = \xi + \eta \sim P(\lambda_1 + \lambda_2)\)。


综上，两个独立泊松分布随机变量的和仍服从泊松分布，且参数为原两个分布参数之和。
### 2.4 数学期望的定义及性质
在求平均值时，理论上应该用概率\(p_k\)去代替上述求和式中的频率\(f_k\)，这时得到的平均值才是理论上的（也是真的）平均值。这个平均值，称为数学期望或简称为期望（或均值）。如果随机变量为\(\xi\)，它的数学期望记作\(E\xi\)。
#### 例 2.14
（1）若随机变量\(\xi\)服从二项分布\(b(n,p)\)，试求它的数学期望\(E\xi\)。
（2）设随机变量\(\xi\)服从参数为\(\lambda\)的泊松分布，试求\(\xi\)的数学期望\(E\xi\)。

**解**：
（1）此时二项分布的概率质量函数为：
\[
p_{k} = P(\xi = k) = \binom{n}{k}p^{k}q^{n - k}, \quad 0 \leq k \leq n
\]
所以数学期望\(E\xi\)为：
\[
\begin{align*}
E\xi &= \sum_{k = 0}^{n} k \cdot p_{k} = \sum_{k = 1}^{n} k \cdot \binom{n}{k}p^{k}q^{n - k}\\
&= np\sum_{k = 1}^{n} \binom{n - 1}{k - 1}p^{k - 1}q^{(n - 1) - (k - 1)}\\
&= np(p + q)^{n - 1} = np
\end{align*}
\]

（2）泊松分布的概率质量函数为：
\[
p_{k} = P(\xi = k) = \frac{\lambda^{k}}{k!}\mathrm{e}^{-\lambda}, \quad k = 0,1,2,\cdots
\]
于是数学期望\(E\xi\)为：
\[
\begin{align*}
E\xi &= \sum_{k = 0}^{+\infty} k \cdot p_{k} = \sum_{k = 1}^{+\infty} k \cdot \frac{\lambda^{k}}{k!}\mathrm{e}^{-\lambda}\\
&= \lambda \cdot \mathrm{e}^{-\lambda}\sum_{k = 1}^{+\infty} \frac{\lambda^{k - 1}}{(k - 1)!} = \lambda
\end{align*}
\]

由此可知泊松分布的随机变量的数学期望就是这个分布的参数\(\lambda\)
#### 离散型随机变量数学期望要求 “绝对收敛” 的原因
在定义离散型随机变量\(\xi\)的数学期望时，我们不仅要求无穷级数\(\sum_{i = 1}^{+\infty} a_{i}p_{i}\)（其中\(a_i\)是\(\xi\)的可能取值，\(p_i = P(\xi = a_i)\)）收敛，更明确要求其绝对收敛（即\(\sum_{i = 1}^{+\infty} |a_{i}|p_{i} < +\infty\)）。这一要求并非多余，而是由数学期望的本质含义和无穷级数的性质共同决定的
### 2.5 方差的定义及性质
#### 定义2.6
设\(\xi\)是一个离散型随机变量，数学期望\(E\xi\)存在，若\(E(\xi - E\xi)^2\)存在，则称\(E(\xi - E\xi)^2\)为随机变量\(\xi\)的方差，记作\(D\xi\)或\(\text{Var}\xi\)。

方差的平方根\(\sqrt{D\xi}\)称为标准差，常记为\(\sigma\)。在实际问题里，标准差应用广泛，优点是它与\(\xi\)具有相同的量纲（或因次）。
#### 例2.17
若\(\xi\)服从参数为\(\lambda\)的泊松分布，试求\(D\xi\)。


解 已知泊松分布的数学期望\(E\xi = \lambda\)，需先计算二阶原点矩\(E\xi^2\)：

\[
\begin{align*}
E\xi^2 &= \sum_{i=1}^{+\infty} i^2 \cdot \frac{\lambda^i}{i!} \mathrm{e}^{-\lambda} \quad \text{（数学期望定义，\(i=0\)时项为0，故从\(i=1\)开始求和）} \\
&= \lambda \mathrm{e}^{-\lambda} \sum_{i=1}^{+\infty} i \cdot \frac{\lambda^{i-1}}{(i-1)!} \quad \text{（提取公因子\(\lambda \mathrm{e}^{-\lambda}\)，利用\(i! = i \cdot (i-1)!\)化简）} \\
&= \lambda \mathrm{e}^{-\lambda} \left[ \sum_{i=1}^{+\infty} (i - 1) \cdot \frac{\lambda^{i-1}}{(i-1)!} + \sum_{i=1}^{+\infty} \frac{\lambda^{i-1}}{(i-1)!} \right] \quad \text{（将\(i\)拆分为\((i-1) + 1\)，拆分求和项）} \\
&= \lambda \mathrm{e}^{-\lambda} \left[ \lambda \sum_{i=2}^{+\infty} \frac{\lambda^{i-2}}{(i-2)!} + \mathrm{e}^\lambda \right] \quad \text{（对第一个级数做变量代换\(k = i-2\)，第二个级数用指数函数展开\(\mathrm{e}^\lambda = \sum_{n=0}^{+\infty} \frac{\lambda^n}{n!}\)）} \\
&= \lambda (\lambda + 1) \quad \text{（约去\(\mathrm{e}^{-\lambda}\)与\(\mathrm{e}^\lambda\)，化简求和结果）} \\
&= \lambda^2 + \lambda
\end{align*}
\]

再由**方差的计算公式** \( D\xi = E\xi^2 - (E\xi)^2 \)，代入\(E\xi = \lambda\)和\(E\xi^2 = \lambda^2 + \lambda\)，得：

\[
D\xi = E\xi^2 - (E\xi)^2 = (\lambda^2 + \lambda) - \lambda^2 = \lambda
\]
### 2.6 条件分布与条件数学期望
\[
\begin{align*}
E(E\{\xi \mid \eta\}) &= \sum_{j=1}^{+\infty} \sum_{i=1}^{+\infty} a_i \frac{p_{ij}}{p_{\cdot j}} p_{\cdot j} = \sum_{i=1}^{+\infty} a_i \cdot \sum_{j=1}^{+\infty} p_{ij} \\
&= \sum_{i=1}^{+\infty} a_i p_{i\cdot} = E\xi \tag{2.35}
\end{align*}
\]
### 习题
2.49：做差分
2.50：容斥
2.51：作比
2.52：可以证明等比性质，由和为1证明为几何分布
2.53：差分
2.54：stiring数加讨论
2.55：期望是概率的倒数
2.56：水
2.57：放到两边，简单放缩
2.58：期望一样，方差也一样
2.59：对称性考虑
2.60：有积性

